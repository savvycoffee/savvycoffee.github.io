<script>
    const signOutButton = document.getElementById('signout-button');
    if (signOutButton) {
        signOutButton.addEventListener('click', handleSignOut);
    } else {};

    function handleSignOut() {
        localStorage.removeItem('client:token')    
        console.log('User signed out')
        authState();
    }
  
    const authToken = localStorage.getItem('client:token');
    let currentPath = window.location.pathname;
    let publicElements = document.querySelectorAll("[data-onlogin='hide']");
    let privateElements = document.querySelectorAll("[data-onlogin='show']");
    let privatePages = [
        '/dashboard',
        '/dashboard/campaigns',
        '/dashboard/create-roaster'
    ];
  
    let publicPages = [
        '/',
        '/roasters/signup',
        '/dashboard/login'
    ];


    axios.get('https://x2u8-93qt-fakz.n7.xano.io/api:rHIcyEeu/auth/me', {
        headers: {
            Authorization: `Bearer ${authToken}`
        }
    })
    .then(response => {
        const user = response.data;
        if (publicPages.includes(currentPath)) { 
            window.location.replace('/dashboard');
            }
            privateElements.forEach(function(element) {
            element.style.display = "initial";
            });      
            publicElements.forEach(function(element) {
            element.style.display = "none";
        });
    })
    .catch(error => {
        if (privatePages.includes(currentPath)) {
            window.location.replace('/access-denied');
            } 
            publicElements.forEach(function(element) {
            element.style.display = "initial";
            });
            privateElements.forEach(function(element) {
            element.style.display = "none";
            });
    })
</script>